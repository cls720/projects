(window.webpackJsonpzhcCmps=window.webpackJsonpzhcCmps||[]).push([[1],{452:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this.$createElement,e=this._self._c||t;return"BirtWorkBook"==this.birtModel.controlName?e("birt-work-book",{ref:this.birtModel.controlId,attrs:{conf:this.birtModel}}):this._e()};i._withStripped=!0;var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"zhc-birt-work-book"},[t.isShowToolBar()?n("birt-tool-bar",{ref:"pageBar",attrs:{"total-page":t.getTotalPage()},on:{"page-change":t.onPageChange}}):t._e(),t._v(" "),t.isInitDataSources()?void 0:t._e(),t._v(" "),t.isRenderTabs()?n("el-tabs",{attrs:{"tab-position":t.tabPosition},on:{"tab-click":t.onTabClick},model:{value:t.activeTabId,callback:function(e){t.activeTabId=e},expression:"activeTabId"}},t._l(t.sheets,function(e,i){return n("el-tab-pane",{key:e.controlId,attrs:{label:e.name,name:e.controlId}},[n("birt-cell-children",{key:t.curtSheet.controlId,style:t.getCurtSheetStyle(),attrs:{children:[t.getCurtSheetConf()]}})],1)}),1):n("birt-cell-children",{key:t.curtSheet.controlId,style:t.getCurtSheetStyle(),attrs:{children:[t.getCurtSheetConf()]}})],2)};r._withStripped=!0;n(2);var o=n(20),a=n(108),s=n(21),c=n(39),h={name:"birt-work-book",components:{BirtCellChildren:o.default,BirtToolBar:a.a},props:{conf:{type:Object,default:function(){return{}}}},data:function(){return{curtPageIndex:0,screenHeight:window.innerHeight,datasource:{},dataset:{}}},provide:function(){return{datasource:this.datasource,dataset:this.dataset}},computed:{mainHeight:function(){var t=this.screenHeight-this.$HCBIRT.tabHeight;return this.isShowToolBar()&&(t-=60),t},activeTabId:{get:function(){return this.curtSheet.controlId},set:function(t){}},confDataSources:function(){return this.conf&&this.conf.dataSources},renderType:function(){return this.conf&&this.conf.renderType||"pages"},tabPosition:function(){return this.conf&&this.conf.tabPosition||"right"},sheets:function(){var t=[];return this.conf.children.forEach(function(e){"BirtSheet"==e.controlName&&t.push(e)}),t},curtSheet:function(){if(this.sheets.length>0)for(var t=0,e=0,n=this.sheets.length;e<n;e++){if(t+=this.sheets[e].children.length,this.curtPageIndex<t){var i=this.sheets[e];return this.initDataSets(i.dataSets),i}}return{}}},watch:{screenHeight:function(t){if(!this.timer){this.screenHeight=t,this.timer=!0;var e=this;setTimeout(function(){e.timer=!1},400)}}},methods:{isShowToolBar:function(){return void 0===this.conf.showToolBar||this.conf.showToolBar},isInitDataSources:function(){return!!this.confDataSources&&(this.initDataSources(this.confDataSources),!0)},autoWidth:function(){return"100%"},autoHeight:function(){return this.mainHeight},registerResize:function(){var t=this;window.onresize=function(){t.screenHeight=window.innerHeight}},initDataSources:function(t){if(t){var e=this;t.forEach(function(t){e.datasource[t.controlId]||(t.dataset=e.dataset,e.datasource[t.controlId]=s.a.newInstance(t))})}},initDataSets:function(t){if(t){var e=this;t.forEach(function(t){e.dataset[t.controlId]||(e.dataset[t.controlId]=s.a.newInstance(t))})}},getDataSetInstance:function(t){return this.dataset[t]},getTotalPage:function(){return this.conf.totalPage},isRenderTabs:function(){return"tabs"===this.renderType},getCurtSheetConf:function(){if(this.curtSheet.children){void 0===this.curtSheet.pageIndex&&console.error("报表模型数据格式错误,sheet.pageIndex起始页未定义");var t=this.curtPageIndex-this.curtSheet.pageIndex;return this.curtSheet.children[t]}},getCurtSheetStyle:function(){return(this.curtSheet.style||"")+"height:".concat(this.mainHeight,"px;overflow:auto;")},getSheetByIndex:function(t){if(this.sheets)return this.sheets[t]},onPageChange:function(t){this.curtPageIndex=t},onTabClick:function(t,e){var n=this.getSheetByIndex(t.index);n&&(this.$refs.pageBar.setCurrentPage(n.pageIndex+1),this.curtPageIndex=n.pageIndex)}},mounted:function(){this.registerResize()},beforeDestroy:function(){for(var t in this.datasource){var e=this.datasource[t];e instanceof c.a&&e.close()}}},u=n(0),d=Object(u.a)(h,r,[],!1,null,"d0869a7a",null);d.options.__file="src/components/Birt/WorkBook/index.vue";var l=d.exports,f=n(63),g={name:"BirtWorkBookView",components:{BirtWorkBook:l},props:{},data:function(){return{birtModel:function(){return{}}}},computed:{},watch:{},methods:{loadBirtModel:function(t,e){var n=this;Object(f.a)(t,e).then(function(t){var e=t.data;n.birtModel=e})}},mounted:function(){this.loadBirtModel(this.$route.path,this.$route.query)}},p=Object(u.a)(g,i,[],!1,null,"7f181659",null);p.options.__file="src/views/birt/workbook/index.vue";e.default=p.exports}}]);